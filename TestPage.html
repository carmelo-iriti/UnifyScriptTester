<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Responsive Form</title>
    <style>
      body {
              background-color: #333; /* Dark background */
              color: #fff; /* Light text */
              font-family: Arial, sans-serif;
          }
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }
        .row {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .input-field {
            flex: 0 0 15%; /* Adjust the width for each input field */
            margin: 10px 0;
            box-sizing: border-box;
        }
        .input-field label {
            display: block;
            margin-bottom: 5px;
        }
        .input-field input {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
        }
        .input-field input, .checkbox-group input, .radio-group input, .button-group button {
            background-color: #555; /* Darker background for input */
            color: #fff; /* Light text for input */
            border: 1px solid #777; /* Slightly lighter border for visibility */
            padding: 10px;
            margin-top: 5px;
        }
        .checkbox-field, .radio-field, .button-field, .data-field {
            flex: 0 0 100%;
            box-sizing: border-box;
            margin-top: 30px; /* Space between rows */
        }
        .checkbox-field > label, .radio-field > label, .button-field > label {
            display: block;
            margin-bottom: 10px;
            color: #fff; /* Light text for labels */
        }
        .checkbox-group, .radio-group, .button-group {
            display: inline-block; /* or use 'flex' */
            margin-right: 20px; /* Spacing between groups */
        }
        .checkbox-group label, .radio-group label, .button-group label {
            margin-left: 5px;
        }
        .button-group button {
            padding: 10px;
            margin-top: 5px;
            transition: transform 0.1s ease;
        }

        .button-group button:active {
            transform: scale(0.95);
        }

        .full-width-input {
            flex: 0 0 100%; /* Take full width */
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .full-width-input input {
            flex-grow: 1; /* Grow to take available space */
            margin-right: 10px; /* Space between input and button */
            background-color: #555; /* Darker background for input */
            color: #fff; /* Light text for input */
            border: 1px solid #777; /* Slightly lighter border for visibility */
            padding: 10px;
            margin-top: 5px;
        }

        .full-width-input button {
            flex-shrink: 0; /* Prevent button from shrinking */
            padding: 10px;
            margin-top: 5px;
            transition: transform 0.1s ease; /* Smooth transition for the press effect */
            background-color: #555; /* Darker background for input */
            color: #fff; /* Light text for input */
            border: 1px solid #777; /* Slightly lighter border for visibility */
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .input-field, .checkbox-group, .radio-group, .button-group {
                flex: 0 0 48%; /* Adjust the width for smaller screens */
            }
        }
        @media (max-width: 480px) {
            .input-field, .checkbox-group, .radio-group, .button-group {
                flex: 0 0 100%; /* Full width on very small screens */
                margin-right: 0;
            }
        }
    </style>
    <script>
        (function () {
            var e = false, c = window, t = document;

            function r() {
                if (!c.frames["__uspapiLocator"]) {
                    if (t.body) {
                        var a = t.body, e = t.createElement("iframe");
                        e.style.cssText = "display:none";
                        e.name = "__uspapiLocator";
                        a.appendChild(e);
                    } else {
                        setTimeout(r, 5);
                    }
                }
            }

            r();

            function p() {
                var a = arguments;
                __uspapi.a = __uspapi.a || [];
                if (!a.length) return __uspapi.a;
                else if (a[0] === "ping") a[2]({gdprAppliesGlobally: e, cmpLoaded: false}, true);
                else __uspapi.a.push([].slice.apply(a));
            }

            function l(t) {
                var r = typeof t.data === "string";
                try {
                    var a = r ? JSON.parse(t.data) : t.data;
                    if (a.__cmpCall) {
                        var n = a.__cmpCall;
                        c.__uspapi(n.command, n.parameter, function (a, e) {
                            var c = {__cmpReturn: {returnValue: a, success: e, callId: n.callId}};
                            t.source.postMessage(r ? JSON.stringify(c) : c, "*");
                        });
                    }
                } catch (a) {}
            }

            if (typeof __uspapi !== "function") {
                c.__uspapi = p;
                __uspapi.msgHandler = l;
                c.addEventListener("message", l, false);
            }
        })();
    </script>

    <script>
      window.__gpp_addFrame=function(e){if(!window.frames[e])if(document.body){var t=document.createElement("iframe");t.style.cssText="display:none",t.name=e,document.body.appendChild(t)}else window.setTimeout(window.__gpp_addFrame,10,e)},window.__gpp_stub=function(){var e=arguments;if(__gpp.queue=__gpp.queue||[],__gpp.events=__gpp.events||[],!e.length||1==e.length&&"queue"==e[0])return __gpp.queue;if(1==e.length&&"events"==e[0])return __gpp.events;var t=e[0],p=e.length>1?e[1]:null,s=e.length>2?e[2]:null;if("ping"===t)p({gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",signalStatus:"not ready",supportedAPIs:["2:tcfeuv2","5:tcfcav1","6:uspv1","7:usnatv1","8:uscav1","9:usvav1","10:uscov1","11:usutv1","12:usctv1"],cmpId:0,sectionList:[],applicableSections:[],gppString:"",parsedSections:{}},!0);else if("addEventListener"===t){"lastId"in __gpp||(__gpp.lastId=0),__gpp.lastId++;var n=__gpp.lastId;__gpp.events.push({id:n,callback:p,parameter:s}),p({eventName:"listenerRegistered",listenerId:n,data:!0,pingData:{gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",signalStatus:"not ready",supportedAPIs:["2:tcfeuv2","5:tcfcav1","6:uspv1","7:usnatv1","8:uscav1","9:usvav1","10:uscov1","11:usutv1","12:usctv1"],cmpId:0,sectionList:[],applicableSections:[],gppString:"",parsedSections:{}}},!0)}else if("removeEventListener"===t){for(var a=!1,i=0;i<__gpp.events.length;i++)if(__gpp.events[i].id==s){__gpp.events.splice(i,1),a=!0;break}p({eventName:"listenerRemoved",listenerId:s,data:a,pingData:{gppVersion:"1.1",cmpStatus:"stub",cmpDisplayStatus:"hidden",signalStatus:"not ready",supportedAPIs:["2:tcfeuv2","5:tcfcav1","6:uspv1","7:usnatv1","8:uscav1","9:usvav1","10:uscov1","11:usutv1","12:usctv1"],cmpId:0,sectionList:[],applicableSections:[],gppString:"",parsedSections:{}}},!0)}else"hasSection"===t?p(!1,!0):"getSection"===t||"getField"===t?p(null,!0):__gpp.queue.push([].slice.apply(e))},window.__gpp_msghandler=function(e){var t="string"==typeof e.data;try{var p=t?JSON.parse(e.data):e.data}catch(e){p=null}if("object"==typeof p&&null!==p&&"__gppCall"in p){var s=p.__gppCall;window.__gpp(s.command,(function(p,n){var a={__gppReturn:{returnValue:p,success:n,callId:s.callId}};e.source.postMessage(t?JSON.stringify(a):a,"*")}),"parameter"in s?s.parameter:null,"version"in s?s.version:"1.1")}},"__gpp"in window&&"function"==typeof window.__gpp||(window.__gpp=window.__gpp_stub,window.addEventListener("message",window.__gpp_msghandler,!1),window.__gpp_addFrame("__gppLocator"));
    </script>

    <script>
        window._sp_ = {
            config: {
                accountId: 22,
                baseEndpoint: 'https://preprod-cdn.privacy-mgmt.com',
                propertyHref: 'https://automation-mobile-usnat',
                // ccpa: {},
                gdpr: {},
                usnat: {
                    transitionCCPAAuth: true
                },
                events: {
                    onConsentReady: function (campaignType, uuid, consent) {
                        displayLocalStorageData();
                        window.postMessage({
                            name: 'onConsentReady',
                            payload: {
                                campaignType,
                                uuid,
                                consent
                            }
                        }, '*');
                        console.log("onConsentReady")
                    },
                    onError: function () {
                        window.postMessage({
                            name: 'onError',
                            payload: {
                                ...arguments
                            }
                        }, '*');
                    },
                }
            }
        }
    </script>
    <script src='https://preprod-cdn.privacy-mgmt.com/unified/wrapperMessagingWithoutDetection.js' async></script>
    <script src='https://d3fkv551xkjrmm.cloudfront.net/js/messaging.js'></script>
    <!-- Include jQuery and json-viewer library -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="src/jquery.json-viewer.js"></script>
    <link href="css/jquery.json-viewer.css" type="text/css" rel="stylesheet">
    <script>

        function clearLocalStorage() {
            localStorage.clear();
            displayLocalStorageData();
            console.log("Local storage cleared");
        }

        function reloadPage() { location.reload(); }
        
        function displayLocalStorageData() {
                var propertyId = $('#propertyId').val();
                var key = '_sp_user_consent_' + propertyId;
                var data = localStorage.getItem(key);
                var displayElement = $('#localStorageData');
                displayElement.empty(); // Clear existing content

                if (data) {
                    var options = {
                        collapsed: $('#collapsed').is(':checked'),
                        rootCollapsable: $('#root-collapsable').is(':checked'),
                        withQuotes: $('#with-quotes').is(':checked'),
                        withLinks: $('#with-links').is(':checked')
                    };
                    displayElement.jsonViewer(JSON.parse(data), options);
                    
                } else {
                    displayElement.text('No data found');
                }
                displayLocalStorageDataAsString();
            }

            function loadGdprPm() {
                var gdprPmId = document.getElementById('gdprPmId').value;
                if (gdprPmId) {
                    window._sp_.gdpr.loadPrivacyManagerModal(gdprPmId);
                } else {
                    console.log("No GDPR PM ID provided");
                }
            }

            function loadCcpaPm() {
                var ccpaPmId = document.getElementById('ccpaPmId').value;
                if (ccpaPmId) {
                    window._sp_.ccpa.loadPrivacyManagerModal(ccpaPmId);
                } else {
                    console.log("No CCPA PM ID provided");
                }
            }

            function loadUsantPm() {
                var usnatPmId = document.getElementById('usnatPmId').value;
                if (usnatPmId) {
                    window._sp_.usnat.loadPrivacyManagerModal(usnatPmId);
                } else {
                    console.log("No USNAT PM ID provided");
                }
            }

            function loadMessages() {

                var isGdprChecked = document.getElementById('checkboxGDPR').checked;
                var isCcpaChecked = document.getElementById('checkboxCCPA').checked;
                var isUsnatChecked = document.getElementById('checkboxUSNAT').checked;

                var spConfig = {
                    config: {
                        accountId: 22,
                        baseEndpoint: 'https://preprod-cdn.privacy-mgmt.com',
                        propertyHref: 'https://automation-mobile-usnat',
                        events: {
                            onConsentReady: function (campaignType, uuid, consent) {
                                displayLocalStorageData();
                                window.postMessage({
                                    name: 'onConsentReady',
                                    payload: {
                                        campaignType,
                                        uuid,
                                        consent
                                    }
                                }, '*');
                                console.log("onConsentReady");
                            },
                            onError: function () {
                                window.postMessage({
                                    name: 'onError',
                                    payload: {
                                        ...arguments
                                    }
                                }, '*');
                            },
                        }
                    }
                };

                if (isGdprChecked) {
                    spConfig.config.gdpr = {};
                }
                if (isCcpaChecked) {
                    spConfig.config.ccpa = {};
                }
                if (isUsnatChecked) {
                    spConfig.config.usnat = {};
                }

                window._sp_ = spConfig;

            }


            function displayLocalStorageDataAsString(){
                var propertyId = $('#propertyId').val();
                var key = '_sp_user_consent_' + propertyId;
                var data = localStorage.getItem(key);
                document.getElementById('storageValue').value = data ? data.toString() : "";
            }

            function saveToLocalStorage() {
                var propertyId = document.getElementById('propertyId').value;
                var storageValue = document.getElementById('storageValue').value;
                var key = '_sp_user_consent_' + propertyId;
                localStorage.setItem(key, storageValue);
                displayLocalStorageData();
                console.log("Value saved to local storage for key", key, ":", storageValue);
            }

            document.addEventListener('DOMContentLoaded', function() {
            // Function to save the state of the checkboxes
            function saveCheckboxState() {
                var gdprChecked = document.getElementById('checkboxGDPR').checked;
                var ccpaChecked = document.getElementById('checkboxCCPA').checked;
                var usnatChecked = document.getElementById('checkboxUSNAT').checked;

                localStorage.setItem('gdprCheckbox', gdprChecked);
                localStorage.setItem('ccpaCheckbox', ccpaChecked);
                localStorage.setItem('usnatCheckbox', usnatChecked);
            }

            // Function to restore the state of the checkboxes
            function restoreCheckboxState() {
                var gdprChecked = JSON.parse(localStorage.getItem('gdprCheckbox'));
                var ccpaChecked = JSON.parse(localStorage.getItem('ccpaCheckbox'));
                var usnatChecked = JSON.parse(localStorage.getItem('usnatCheckbox'));

                document.getElementById('checkboxGDPR').checked = gdprChecked;
                document.getElementById('checkboxCCPA').checked = ccpaChecked;
                document.getElementById('checkboxUSNAT').checked = usnatChecked;
            }

            // Event listeners for checkbox state changes
            document.getElementById('checkboxGDPR').addEventListener('change', saveCheckboxState);
            document.getElementById('checkboxCCPA').addEventListener('change', saveCheckboxState);
            document.getElementById('checkboxUSNAT').addEventListener('change', saveCheckboxState);

            // Restore state on page load
            restoreCheckboxState();
        });

    </script>
    <script>
        $(function() {
            $('#btn-json-viewer').click(displayLocalStorageData);
            $('p.options input[type=checkbox]').click(displayLocalStorageData);

            displayLocalStorageData();
        });
    </script>
</head>
<body">
    <div class="container">
        <div class="row">
            <div class="input-field">
                <label for="propertyId">Property Id</label>
                <input type="text" id="propertyId" value="34049">
            </div>
            <div class="input-field">
                <label for="accountId">Account Id</label>
                <input type="text" id="accountId">
            </div>
            <div class="input-field">
                <label for="propertyName">Property Name</label>
                <input type="text" id="propertyName">
            </div>
            <div class="input-field">
                <label for="authId">Auth Id</label>
                <input type="text" id="authId">
            </div>
        </div>
        <div class="row">
            <div class="checkbox-field">
                <label>Campaigns</label>
                <div class="checkbox-group">
                    <input type="checkbox" id="checkboxGDPR">
                    <label for="checkboxGDPR">GDPR</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="checkboxCCPA">
                    <label for="checkboxCCPA">CCPA</label>
                </div>
                <div class="checkbox-group">
                    <input type="checkbox" id="checkboxUSNAT">
                    <label for="checkboxUSNAT">USNAT</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="radio-field">
                <label>Radio Buttons</label>
                <div class="radio-group">
                    <input type="radio" id="radio1" name="radio-group" checked>
                    <label for="radio1">Radio 1</label>
                </div>
                <div class="radio-group">
                    <input type="radio" id="radio2" name="radio-group">
                    <label for="radio2">Radio 2</label>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="input-field">
                <label for="gdprPmId">GDPR PmId</label>
                <input type="text" id="gdprPmId" value="899812">
            </div>
            <div class="input-field">
                <label for="ccpaPmId">CCPA PmId</label>
                <input type="text" id="ccpaPmId" value="899813">
            </div>
            <div class="input-field">
                <label for="usnatPmId">USNAT PmId</label>
                <input type="text" id="usnatPmId" value="0000">
            </div>
        </div>
        <div class="row">
            <div class="button-field">
                <label>Privacy Manager</label>
                <div class="button-group">
                    <button type="button" onclick="loadGdprPm()">GDPR Pm</button>
                </div>
                <div class="button-group">
                    <button type="button" onclick="loadCcpaPm()">CCPA Pm</button>
                </div>
                <div class="button-group">
                    <button type="button" onclick="loadUsantPm()">USNAT Pm</button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="button-field">
                <label>Utils</label>
                <div class="button-group">
                    <button type="button" onclick="loadMessages()">Load Messages</button>
                </div>
                <div class="button-group">
                    <button type="button" onclick="clearLocalStorage()">Clea Local Storage</button>
                </div>
                <div class="button-group">
                    <button type="button" onclick="reloadPage()">Reload Page</button>
                </div>
                <div class="button-group">
                    <button type="button" onclick="displayLocalStorageData()">Show LocalStorage</button>
                </div>
            </div>
        </div>
        <div class="row" style="margin-top: 30px;">
            <label for="storageValue">Value for Local Storage:</label>
            <div class="full-width-input">
                <input type="text" id="storageValue" placeholder="Enter value">
                <button type="button" onclick="saveToLocalStorage()">Save to Local Storage</button>
            </div>
        </div>
        <div class="row">
            <div class="data-field">
                <label>Local Storage Data</label>
                <pre id="localStorageData"></pre> <!-- Element to display the data -->
            </div>
        </div>
    </div>
</body>
</html>
